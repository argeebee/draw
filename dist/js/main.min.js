var draw=function(){var t=document.querySelector("main"),e=t.offsetWidth,n=t.offsetHeight,r=document.createElement("canvas"),a=r.getContext("2d"),i=r.getBoundingClientRect(),o=0,d=0,c=0,s=0,l=0,u=0,w=!1,f=!1,h="",g=!1;return{setIsDrawing:function(t){g=t},getIsDrawing:function(){return g},getShape:function(){return h},setShape:function(t){h=t},randColor:function(){return"#"+Math.floor(16777215*Math.random()).toString(16)},setStart:function(){c=o,s=d},setEnd:function(){l=o,u=d},setXY:function(t){w=o,f=d,o=t.clientX-i.left-r.offsetLeft,d=t.clientY-i.top-r.offsetTop},writeXY:function(){document.getElementById("trackX").innerHTML="X: "+o,document.getElementById("trackY").innerHTML="Y: "+d},draw:function(){switch(a.restore(),h){case"rectangle":this.drawRect();break;case"line":this.drawLine();break;case"circle":this.drawCircle();break;case"path":this.drawPath()}a.save()},drawCircle:function(){a.strokeStyle=this.randColor(),a.fillStyle=this.randColor();var t=c-l,e=s-u,n=Math.sqrt(t*t+e*e);a.beginPath(),a.arc(c,s,n,0,2*Math.PI),a.stroke(),a.fill()},drawPath:function(){a.strokeStyle=this.randColor(),a.beginPath(),a.moveTo(w,f),a.lineTo(o,d),a.stroke()},drawLine:function(){a.strokeStyle=this.randColor(),a.beginPath(),a.moveTo(c,s),a.lineTo(l,u),a.stroke()},drawRect:function(){a.fillStyle=this.randColor(),a.fillRect(c,s,l-c,u-s),a.strokeStyle=this.randColor(),a.lineWidth=3,a.strokeRect(c,s,l-c,u-s)},getCanvas:function(){return r},init:function(){r.width=e,r.height=n,t.appendChild(r)}}}();draw.init(),document.getElementById("btnRect").addEventListener("click",function(){draw.setShape("rectangle")}),document.getElementById("btnLine").addEventListener("click",function(){draw.setShape("line")}),document.getElementById("btnCircle").addEventListener("click",function(){draw.setShape("circle")}),document.getElementById("btnPath").addEventListener("click",function(){draw.setShape("path")}),draw.getCanvas().addEventListener("mousedown",function(){draw.setStart(),draw.setIsDrawing(!0)}),draw.getCanvas().addEventListener("mouseup",function(){draw.setEnd(),draw.draw(),draw.setIsDrawing(!1)}),draw.getCanvas().addEventListener("mousemove",function(t){draw.setXY(t),draw.writeXY(),"path"===draw.getShape()&&!0===draw.getIsDrawing()&&draw.draw()}),draw.drawRect();