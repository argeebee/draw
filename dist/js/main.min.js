var draw=function(){var e=document.querySelector("main"),t=e.offsetWidth,r=e.offsetHeight,n=document.createElement("canvas"),i=n.getContext("2d"),o=n.getBoundingClientRect(),a=0,s=0,l=0,d=0,c=0,h=0,u=!1,y=!1,f="",m=!1,w=[];return{setIsDrawing:function(e){m=e},getIsDrawing:function(){return m},getShape:function(){return f},setShape:function(e){f=e},randColor:function(){return"#"+Math.floor(16777215*Math.random()).toString(16)},setStart:function(){l=a,d=s},setEnd:function(){c=a,h=s},setXY:function(e){u=a,y=s,a=e.clientX-o.left-n.offsetLeft,s=e.clientY-o.top-n.offsetTop},writeXY:function(){document.getElementById("trackX").innerHTML="X: "+a,document.getElementById("trackY").innerHTML="Y: "+s},draw:function(){switch(i.restore(),f){case"rectangle":this.drawRect();break;case"line":this.drawLine();break;case"circle":this.drawCircle();break;case"triangle":this.drawTriangle();break;case"path":this.drawPath()}i.save()},drawCircle:function(){i.strokeStyle=this.randColor(),i.fillStyle=this.randColor();var e=l-c,t=d-h,r=Math.sqrt(e*e+t*t);i.beginPath(),i.arc(l,d,r,0,2*Math.PI),i.stroke(),i.fill(),w.push({shape:"circle",coords:{x1:l,y1:d,x2:c,y2:h},styles:{stroke:i.strokeStyle,fill:i.fillStyle}})},drawTriangle:function(){var e=l-c,t=d-h,r=Math.sqrt(e*e+t*t),n=l+r,o=d+r;c<l&&(n=l-r),h<d&&(o=d-r),i.fillStyle=this.randColor(),i.strokeStyle=this.randColor(),i.beginPath(),i.moveTo(l,d),i.lineTo(n,o),i.lineTo(c,h),i.lineTo(l,d),i.stroke(),i.fill(),w.push({shape:"triangle",coords:{points:{x1:l,y1:d,x2:c,y2:h}},styles:{stroke:i.strokeStyle,fill:i.fillStyle}})},drawPath:function(){i.strokeStyle=this.randColor(),i.beginPath(),i.moveTo(u,y),i.lineTo(a,s),i.stroke(),w.push({shape:"path",coords:{lx:u,ly:y,x:a,y:s},styles:{stroke:i.strokestyle}})},drawLine:function(){i.strokeStyle=this.randColor(),i.beginPath(),i.moveTo(l,d),i.lineTo(c,h),i.stroke(),w.push({shape:"line",coords:{x1:l,y1:l,x2:c,y2:h},styles:{stroke:i.strokestyle}})},drawRect:function(){i.fillStyle=this.randColor(),i.fillRect(l,d,c-l,h-d),i.strokeStyle=this.randColor(),i.lineWidth=3,i.strokeRect(l,d,c-l,h-d),w.push({shape:"rectangle",coords:{x1:l,y1:d,x2:c,y2:h},styles:{stroke:i.randColor,fill:i.randColor}})},clear:function(){n.width=n.width},redraw:function(){for(item in w){switch(f){case"path":f=w[item].shape,u=w[item].coords.lx,y=w[item].coords.ly,a=w[item].coords.x,s=w[item].coords.y,i.strokeStyle=w[item].styles.stroke;break;case"circle":f=w[item].shape,l=w[item].coords.x1,d=w[item].coords.y1,c=w[item].coords.x2,h=w[item].coords.y2,i.strokeStyle=w[item].styles.stroke,i.fillStyle=w[item].styles.fill;break;case"line":f=w[item].shape,l=w[item].coords.x1,d=w[item].coords.y1,c=w[item].coords.x2,h=w[item].coords.y2,i.strokeStyle=w[item].styles.stroke;break;case"rectangle":case"triangle":f=w[item].shape,l=w[item].coords.x1,d=w[item].coords.y1,c=w[item].coords.x2,h=w[item].coords.y2,i.strokeStyle=w[item].styles.stroke,i.fillStyle=w[item].styles.fill}this.draw()}},getCanvas:function(){return n},init:function(){n.width=t,n.height=r,e.appendChild(n)}}}();draw.init(),document.getElementById("btnRect").addEventListener("click",function(){draw.setShape("rectangle")}),document.getElementById("btnTri").addEventListener("click",function(){draw.setShape("triangle")}),document.getElementById("btnLine").addEventListener("click",function(){draw.setShape("line")}),document.getElementById("btnCircle").addEventListener("click",function(){draw.setShape("circle")}),document.getElementById("btnPath").addEventListener("click",function(){draw.setShape("path")}),document.getElementById("btnClear").addEventListener("click",function(){confirm("Are you sure you want to clear the canvas?")&&draw.clear()}),document.getElementById("btnRedraw").addEventListener("click",function(){confirm("Are you sure you want to redraw the canvas?")&&draw.redraw()}),draw.getCanvas().addEventListener("mousedown",function(){draw.setStart(),draw.setIsDrawing(!0)}),draw.getCanvas().addEventListener("mouseup",function(){draw.setEnd(),draw.draw(),draw.setIsDrawing(!1)}),draw.getCanvas().addEventListener("mousemove",function(e){draw.setXY(e),draw.writeXY(),"path"===draw.getShape()&&!0===draw.getIsDrawing()&&draw.draw()}),draw.drawRect();